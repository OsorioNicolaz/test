<section class="flex h-full flex-col items-center justify-center gap-5">
  <h1 class="w-80 text-pretty text-center text-2xl">
    Registro en Parinacoop
  </h1>
  <div class="flex flex-col items-center justify-center gap-5 rounded-xl bg-[#F6F6F6] px-10 py-5">

    <!-- PASO 1: RUN Y CLAVE -->
    <form
      *ngIf="step === 1"
      class="flex flex-col items-center justify-center gap-5"
      (ngSubmit)="onUserDataSubmit()"
      [formGroup]="userForm"
    >
      <div class="w-72">
        <label class="block mb-2">RUN</label>
        <input type="text" formControlName="run"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="userForm.get('run')?.invalid && userForm.get('run')?.touched" class="text-xs text-red-400 mt-1">
          Este campo es obligatorio
        </div>
      </div>
      <div class="w-72">
        <label class="block mb-2">Contraseña</label>
        <input type="password" formControlName="password"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched" class="text-xs text-red-400 mt-1">
          Mínimo 8 caracteres
        </div>
      </div>
      <div class="w-72">
        <label class="block mb-2">Confirmar contraseña</label>
        <input type="password" formControlName="confirmPassword"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="userForm.hasError('passwordsMismatch') && userForm.get('confirmPassword')?.touched"
          class="text-xs text-red-400 mt-1">
          Las contraseñas deben coincidir
        </div>
      </div>
      <button
        class="h-10 w-72 rounded-full bg-primary-500 text-white transition-colors duration-100
        disabled:bg-primary-100 disabled:text-primary-400 hover:bg-primary-600"
        type="submit"
        [disabled]="userForm.invalid"
      >
        Siguiente
      </button>
    </form>

    <!-- PASO 2: DIRECCIÓN -->
    <form
      *ngIf="step === 2"
      class="flex flex-col items-center justify-center gap-5"
      (ngSubmit)="onAddressSubmit()"
      [formGroup]="addressForm"
    >
      <div class="w-72">
        <label class="block mb-2">Calle</label>
        <input type="text" formControlName="street"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="addressForm.get('street')?.invalid && addressForm.get('street')?.touched" class="text-xs text-red-400 mt-1">
          Este campo es obligatorio
        </div>
      </div>
      <div class="w-72">
        <label class="block mb-2">Número</label>
        <input type="number" formControlName="number"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="addressForm.get('number')?.errors?.['min'] && addressForm.get('number')?.touched" class="text-xs text-red-400 mt-1">
          El número debe ser positivo
        </div>
        <div *ngIf="addressForm.get('number')?.errors?.['required'] && addressForm.get('number')?.touched" class="text-xs text-red-400 mt-1">
          Este campo es obligatorio
        </div>
      </div>
      <div class="w-72">
        <label class="block mb-2">Comuna</label>
        <input type="text" formControlName="commune_id"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
        <div *ngIf="addressForm.get('commune_id')?.invalid && addressForm.get('commune_id')?.touched" class="text-xs text-red-400 mt-1">
          Este campo es obligatorio
        </div>
      </div>
      <div class="w-72">
        <label class="block mb-2">Detalles (opcional)</label>
        <input type="text" formControlName="detail"
          class="w-72 h-12 rounded-md border border-gray-400 bg-[#F6F6F6] px-4 text-base outline-none focus:ring-2 focus:ring-primary-300" />
      </div>

      <button
        class="h-10 w-72 rounded-full bg-primary-500 text-white transition-colors duration-100
        disabled:bg-primary-100 disabled:text-primary-400 hover:bg-primary-600"
        type="submit"
        [disabled]="addressForm.invalid"
      >
        Registrar dirección
      </button>
    </form>
  </div>
</section>